# -*- coding: utf-8 -*-
"""Student Score Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1_IL7jXfvICmbBASBz8qTopIIA7ew8tkL
"""

# -----------------------------------------
# 1. IMPORT LIBRARIES
# -----------------------------------------

# pandas for handling data tables
import pandas as pd

# numpy for numerical operations
import numpy as np

# train_test_split to split data into train and test sets
from sklearn.model_selection import train_test_split

# LinearRegression model
from sklearn.linear_model import LinearRegression

# metrics to evaluate model performance
from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score

# matplotlib for plotting graphs
import matplotlib.pyplot as plt

# -----------------------------------------
# 2. CREATE A SIMPLE DATASET
# -----------------------------------------
# Here we create a small dataset manually.
# In real projects, you will load from CSV, database, etc.

data = {
    "study_hours":    [1, 2, 3, 4, 5, 6, 2, 3, 4, 5, 6, 7, 8, 3, 4, 5, 6, 7, 8, 9],
    "attendance_pct": [50,60,65,70,75,80,55,60,68,72,78,82,88,62,70,74,79,85,90,95],
    "score":          [35,40,45,50,55,60,38,42,48,52,58,63,70,44,49,54,59,66,72,78]
}

# Convert dictionary to DataFrame (table)
df = pd.DataFrame(data)

print("First 5 rows of data:")
print(df.head())

# -----------------------------------------
# 3. EXPLORATORY DATA ANALYSIS (EDA)
# -----------------------------------------

print("\nBasic statistics:")
print(df.describe())

# Scatter plot: study_hours vs score
plt.figure()
plt.scatter(df["study_hours"], df["score"])
plt.xlabel("Study Hours")
plt.ylabel("Score")
plt.title("Study Hours vs Score")
plt.show()

# Scatter plot: attendance vs score
plt.figure()
plt.scatter(df["attendance_pct"], df["score"])
plt.xlabel("Attendance (%)")
plt.ylabel("Score")
plt.title("Attendance vs Score")
plt.show()

# -----------------------------------------
# 4. PREPARE FEATURES (X) AND TARGET (y)
# -----------------------------------------

# Features (inputs) -> study_hours and attendance_pct
X = df[["study_hours", "attendance_pct"]]

# Target (output) -> score
y = df["score"]

# -----------------------------------------
# 5. TRAIN-TEST SPLIT
# -----------------------------------------
# test_size=0.2 -> 20% data for testing, 80% for training
# random_state=42 -> for same random split every time

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

print("\nTraining samples:", len(X_train))
print("Testing samples:", len(X_test))

# -----------------------------------------
# 6. CREATE AND TRAIN THE MODEL
# -----------------------------------------

model = LinearRegression()   # create model object
model.fit(X_train, y_train)  # train model on training data

print("\nModel trained successfully!")

# -----------------------------------------
# 7. MAKE PREDICTIONS ON TEST DATA
# -----------------------------------------

y_pred = model.predict(X_test)

print("\nActual scores:   ", list(y_test.values))
print("Predicted scores:", [round(p, 2) for p in y_pred])

# -----------------------------------------
# 8. EVALUATE MODEL PERFORMANCE
# -----------------------------------------

mae = mean_absolute_error(y_test, y_pred)       # average absolute error
mse = mean_squared_error(y_test, y_pred)        # square error
rmse = np.sqrt(mse)                             # root mean square error
r2 = r2_score(y_test, y_pred)                   # R^2 score (0 to 1, higher is better)

print("\nModel Evaluation:")
print(f"MAE  (Mean Absolute Error): {mae:.2f}")
print(f"RMSE (Root Mean Squared Error): {rmse:.2f}")
print(f"R^2 Score: {r2:.2f}")

# -----------------------------------------
# 9. USE MODEL FOR NEW PREDICTIONS
# -----------------------------------------
# Function to predict score based on user input

def predict_score(study_hours, attendance_pct):
    """
    Predicts student score using trained model.
    study_hours: number of hours student studied
    attendance_pct: attendance percentage (0 to 100)
    """
    features = np.array([[study_hours, attendance_pct]])  # 2D array for model
    predicted = model.predict(features)[0]                # get first value
    return predicted

# Example: predict for a student who studied 5 hours and has 80% attendance
example_hours = 5
example_attendance = 80
predicted_score = predict_score(example_hours, example_attendance)

print(f"\nExample Prediction:")
print(f"For {example_hours} study hours and {example_attendance}% attendance,")
print(f"Predicted Score = {predicted_score:.2f}")

# -----------------------------------------
# 10. (OPTIONAL) TAKE INPUT FROM USER
# -----------------------------------------

# Uncomment this part if you want to enter values manually in console.
# In Colab, it works in the output cell.

# user_hours = float(input("\nEnter study hours: "))
# user_attendance = float(input("Enter attendance percentage: "))
# user_prediction = predict_score(user_hours, user_attendance)
# print(f"Predicted score for you = {user_prediction:.2f}")